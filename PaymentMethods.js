import{S as H}from"./Spinner.js";import{_ as x}from"./plugin-vue_export-helper.js";import{d as O,o as s,e as o,D as T,f as t,t as r,p as f,v as I,M as S,r as g,S as E,E as B,q as m,j as n,F as P,i as v,w as k,y as M,h as C,g as G}from"./index.js";const q={class:"index-page"},z={key:0},D={key:1,class:"cb-header"},K={key:"content"},Q=O({props:{header:String,inited:Boolean},setup(a){return(i,h)=>(s(),o("div",q,[i.$slots.header?(s(),o("div",z,[T(i.$slots,"header",{},void 0,!0)])):a.header?(s(),o("div",D,[t("h1",null,r(a.header),1)])):f("",!0),t("div",null,[t("div",null,[a.inited?(s(),o("div",K,[T(i.$slots,"default",{},void 0,!0)])):(s(),I(H,{key:1}))])])]))}});var W=x(Q,[["__scopeId","data-v-999acb9a"]]);const X={[S.PAYMENT_METHODS]:"listPaymentmethod",[S.SUBSCRIPTIONS]:"listSubscriptions"};function Z(a){const i=g(null),h=g(null),p=g(!1);async function d(y){i.value=null,h.value=null,p.value=!0;const{authenticationToken:c}=y;try{i.value=await E[X[a]](c)}catch(l){l.value=l}finally{p.value=!1}}return d({authenticationToken:"123"}),[i,h,p,d]}var N="https://cb-shopify-portal.netlify.app/visa.svg",A="https://cb-shopify-portal.netlify.app/jcb.svg",R="https://cb-shopify-portal.netlify.app/mastercard.svg",ee="https://cb-shopify-portal.netlify.app/unionpay.svg",te="https://cb-shopify-portal.netlify.app/amex.svg",ae="https://cb-shopify-portal.netlify.app/dinersclub.svg",se="https://cb-shopify-portal.netlify.app/discover.svg",ne="https://cb-shopify-portal.netlify.app/paypal.svg",oe="https://cb-shopify-portal.netlify.app/apple-pay.svg",ie="https://cb-shopify-portal.netlify.app/google-pay.svg",re="https://cb-shopify-portal.netlify.app/shop-pay.svg",le="https://cb-shopify-portal.netlify.app/card.svg",w=(a=>(a.visa="Visa",a.mastercard="MasterCard",a.american_express="American Express",a.discover="Discover",a.diners_club="Diners Club",a.jcb="JCB",a.unionpay="UnionPay",a.unknown="Card",a))(w||{});const pe={class:"pm-container"},de={class:"pm-info-wrapper"},ce={class:"pm-info"},ue=["src"],he={class:"pm-title"},ye={class:"pm-status"},me={class:"pm-timeline"},ve={key:1},_e={key:0,class:"pm-edit-container"},fe={class:"pm-edit-info"},ge={class:"pm-edit-note"},be={class:"pm-edit-ctas"},Pe=v(" Send update Email "),ke=v(" Cancel "),$e=O({props:{pm:Object},setup(a){const i=a,h={visa:N,jcb:A,american_express:te,diners_club:ae,discover:se,mastercard:R,unionpay:ee},{t:p}=B(),d=g(!1),y=g(!1),c=m(()=>{const{lastDigits:e,brand:b,paypalAccountEmail:J,source:Y}=u.value;if(L)switch(Y){case"apple_pay":return{title:p("portal.payment_method.card_ending",{method:"Apple Pay",lastDigits:e}),logo:oe};case"google_pay":return{title:p("portal.payment_method.card_ending",{method:"GPay",lastDigits:e}),logo:ie};default:return{title:p("portal.payment_method.card_ending",{method:w[b]||w.unknown,lastDigits:e}),logo:h[b]||le}}else{if(U)return{title:`PayPal ${J}`,logo:ne};if(V)return{title:`Shop Pay ending ${e}`,logo:re}}return{}}),{pm:l}=i,_=m(()=>(l==null?void 0:l.instrument)||{}),L=m(()=>!!_.value.customerCreditCard),U=m(()=>!!_.value.customerPaypalBillingAgreement),V=m(()=>!!_.value.customerShopPayAgreement),u=m(()=>_.value[Object.keys(_.value)[0]]||{});function $(){d.value=!d.value}function j(e=1){return["","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][e]}async function F(){y.value=!0;try{const{id:e}=l||{};if(e)await E.sendUpdatePaymentmethodMail(e,"123"),alert("Email sent. Follow the instructions to update your payment method."),$();else throw"Something went wrong"}catch{alert("error")}finally{y.value=!1}}return(e,b)=>(s(),o("div",pe,[t("div",de,[t("div",ce,[t("img",{class:"pm-logo",src:n(c).logo,alt:"Payment method"},null,8,ue),t("div",null,[t("div",he,r(n(c).title),1),t("div",ye,[n(u).expiryMonth&&n(u).expiryYear?(s(),o(P,{key:0},[t("span",me,[n(u).expired?(s(),o(P,{key:0},[v(r(e.$t("portal.payment_method.expired")),1)],64)):(s(),o(P,{key:1},[v(r(e.$t("portal.payment_method.valid_until")),1)],64))]),t("span",null,r(j(n(u).expiryMonth))+" "+r(n(u).expiryYear),1)],64)):n(u).inactive?(s(),o("span",ve,r(e.$t("shopify.subscriptions_page.details.payment_methods.inactice")),1)):f("",!0)])])]),t("div",null,[d.value?f("",!0):(s(),I(n(M),{key:0,class:"pm-edit-btn",variant:"link",onClick:$},{default:k(()=>[v(r(e.$t("portal.common.edit")),1)]),_:1}))])]),d.value?(s(),o("div",_e,[t("div",fe,[t("ul",null,[t("li",null,r(e.$t("portal.payment_method.send_edit_mail.title1")),1),t("li",null,r(e.$t("portal.payment_method.send_edit_mail.title2")),1),t("li",null,[t("span",ge,r(e.$t("portal.common.note"))+":",1),v(" "+r(e.$t("portal.payment_method.send_edit_mail.note")),1)])])]),t("div",be,[C(n(M),{variant:"primary",class:"pm-edit-primary-cta",onClick:F,loading:y.value},{default:k(()=>[Pe]),_:1},8,["loading"]),C(n(M),{variant:"link",onClick:$},{default:k(()=>[ke]),_:1})])])):f("",!0)]))}});var Me=x($e,[["__scopeId","data-v-795380b2"]]);const Se={key:0,class:"pm-main-container"},Ce=O({setup(a){const[i,h,p]=Z(S.PAYMENT_METHODS);return(d,y)=>(s(),I(W,{header:d.$t("portal.payment_methods"),inited:!n(p)},{default:k(()=>{var c;return[(c=n(i))!=null&&c.customerPaymentMethods?(s(),o("div",Se,[(s(!0),o(P,null,G(n(i).customerPaymentMethods,l=>(s(),o("div",{key:l.id},[C(Me,{pm:l},null,8,["pm"])]))),128))])):f("",!0)]}),_:1},8,["header","inited"]))}});var Ie=x(Ce,[["__scopeId","data-v-4b634296"]]);export{Ie as default};
